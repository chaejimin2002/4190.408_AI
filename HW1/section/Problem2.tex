\section*{Problem 2. Probability}

\textbf{Problem 2.1 : Bayes' Theorem} \\
\\
There are three machines $M_1, M_2, M_3$ accounting for 20\%, 30\%, and 50\% of the total production, respectively. And the probability of defective products from each machine is 3\%, 2\%, and 1\%, respectively. \\
\\
Thus, the probablilty of defective products is :
\begin{align*}
    \Pr(F) &= \Pr(M_1 \cap F) + \Pr(M_2 \cap F) + \Pr(M_3 \cap F) \\
    &= \Pr(M_1) \Pr(F|M_1) + \Pr(M_2) \Pr(F|M_2) + \Pr(M_3) \Pr(F|M_3) \\
    &= 0.2 \times 0.03 + 0.3 \times 0.02 + 0.5 \times 0.01 \\
    &= 0.017
\end{align*}

\noindent If one randomly chosen product is defective, the probability for each machine is :

\begin{align*}
    \Pr(M_1|F) &= \frac{\Pr(M_1 \cap F)}{\Pr(F)} \\
    &= \frac{\Pr(M_1) \Pr(F|M_1)}{\Pr(F)} \quad \text{(by Bayes' Theorem)} \\
    &= \frac{0.2 \times 0.03}{0.017} \\
    &= \frac{6}{17}
\end{align*}

\begin{align*}
    \Pr(M_2|F) &= \frac{\Pr(M_2 \cap F)}{\Pr(F)} \\
    &= \frac{\Pr(M_2) \Pr(F|M_2)}{\Pr(F)} \quad \text{(by Bayes' Theorem)} \\
    &= \frac{0.3 \times 0.02}{0.017} \\
    &= \frac{6}{17}
\end{align*}

\begin{align*}
    \Pr(M_3|F) &= \frac{\Pr(M_3 \cap F)}{\Pr(F)} \\
    &= \frac{\Pr(M_3) \Pr(F|M_3)}{\Pr(F)} \quad \text{(by Bayes' Theorem)} \\
    &= \frac{0.5 \times 0.01}{0.017} \\
    &= \frac{5}{17}
\end{align*}\\

\noindent\textbf{Problem 2.2 : Gaussian Distribution} \\
\\
Probability Density Function : $X \sim \Normal(\mu, \sigma^2)$ \\ 
\begin{align*}
    f_X(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}
\end{align*}
Thus, MGF of $X$ is :
\begin{align*}
    M_X(t) &= \E[e^{tX}] \\
    &= \int_{ -\infty }^{ \infty } e^{tx} \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{1}{2} \left( \frac{x-\mu}{\sigma} \right)^2} dx \\
    &= \int_{-\infty}^{\infty} \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{1}{2\sigma^2} \left( x^2 -2x\mu + \mu^2 -2tx\sigma^2\right)} dx \\
    &= \int_{-\infty}^{\infty} \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{1}{2\sigma^2} \left( x-\mu-\sigma^2 t\right)^2} e^{\mu t + \frac{1}{2} \sigma^2 t^2} dx \\
    &= e^{\mu t + \frac{1}{2} \sigma^2 t^2} \int_{-\infty}^{\infty} \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{1}{2\sigma^2} \left( x-\mu-\sigma^2 t\right)^2} dx \\
    &= e^{\mu t + \frac{1}{2} \sigma^2 t^2}
\end{align*}
For two independent random variables $X \sim \Normal(0, 1)$ and $Y \sim \Normal(0, 1)$, the MGF of $Z = X+Y$ is :
\begin{align*}
    M_Z(t) &= M_{X+Y}(t) \\
    &= \E[e^{t(X+Y)}] \\
    &= \E[e^{tX}] \E[e^{tY}] \\
    &= e^{\frac{1}{2} t^2} e^{\frac{1}{2} t^2} \\
    &= e^{t^2}\\
    &= e^{0 \times t + \frac{1}{2} \times 2 \times t^2}
\end{align*}
Thus, $Z \sim \Normal(0, 2)$ by the uniqueness of MGF. \\

\noindent\textbf{Problem 2.3 : KL Divergence} \\
\\
The KL divergence between two distributions $p$ and $q$ is defined as :
\begin{align*}
    D_{KL}(p || q) = -\int_{-\infty}^{\infty} p(x) \log \frac{q(x)}{p(x)} dx
\end{align*}
And then, for $f(x) = - \log x$, it is convex because $\frac{d^2}{dx^2} f(x) = \frac{1}{x^2} > 0$. \\
Thus, by Jensen's Inequality, we have :
\begin{align*}
    f(\E[X]) \leq \E[f(X)]
\end{align*}
Let's say $Z = \frac{q(x)}{p(x)}$ is a random variable and $p(x)$ is the probability distribution of $Z$. Then, we can rewrite the inequality as :
\begin{align*}
    -\log \E[Z] \leq \E[-\log Z]
\end{align*}
This time, $\E[Z] = 1$ because :
\begin{align*}
    \E[Z] = \int_{-\infty}^{\infty} \frac{q(x)}{p(x)} p(x) dx = \int_{-\infty}^{\infty} q(x) dx = 1
\end{align*}
And we know that $D_{KL}(p || q) = \E[-\log \frac{q(x)}{p(x)}] = \E[-\log Z]$. Therefore,
\begin{align*}
    0 \leq D_{KL}(p || q)
\end{align*}


